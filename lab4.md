# Создание диаграмм взаимодействия
 
## Прецедент "Войти в игру"

Рисунок 1 - Диаграмма взаимодействия для прецедента "Войти в игру"

![Рисунок 1 - Диаграмма взаимодействия для прецедента "Войти в игру"](/images/lab4_1.drawio3.png)

| **Операция** | StartSystem()                                        |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Войти в игру"                             |
| Предусловия  | <p>1.	Предыдущая игра завершена</p><p>2.	Новая игра не начата</p><p>3. Игрок нажал кнопку "Начать игру"</p> |
| Постусловия  | Система запущена, Создан новый экземпляр класса Game |

| **Операция** | NameRequest()                                        |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Войти в игру"                             |
| Предусловия  | <p>1.	Система игры запущена</p><p>2.	Новая игра не начата</p><p>3. Игрок еще не вводил свое имя</p> |
| Постусловия  | Посредством интерфейса у игрока запрошено его имя |

| **Операция** | CreatePlayer(name)                                   |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Войти в игру"                             |
| Предусловия  | Имя игрока введено в поле |
| Постусловия  | Создан экземпляр player класса Player. Атрибуту player.name присвоено значение name, введенное игроком |

| **Операция** | AddPlayer(player)                                    |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Войти в игру"                             |
| Предусловия  | Создан новый экземпляр класса Player                 |
| Постусловия  | В атрибут players текущего экземпляра класса Game добавлен созданный player |


## Прецедент "Расставить корабли"

Рисунок 2 - Диаграмма взаимодействия для прецедента "Расставить корабли"

![Рисунок 2 - Диаграмма взаимодействия для прецедента "Расставить корабли"](/images/lab4_2.drawio3.png)

| **Операция** | StartPlacementShips()                                |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Расставить корабли"                       |
| Предусловия  | <p>1.	Новая игра не начата</p><p>2.	Оба игрока ввели свое имя</p> |
| Постусловия  | <p>1. Создан список cells экземпляров класса Cell</p><p>2. В атрибут cells текущего экземпляра класса Game добавлен созданный cells</p> |

| **Операция** | ShowNewField(cells[])                                |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Расставить корабли"                       |
| Предусловия  | Создан список cells экземпляров класса Cell          |
| Постусловия  | Игроку предоставлен интерфейс для расстановки кораблей |

| **Операция** | PlacementShips(ships[])                              |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Расставить корабли"                       |
| Предусловия  | Игрок расставил корабли по полю                      |
| Постусловия  | <p>1. Создан список ships[] с параметрами расстановки кораблей</p><p>2. Создан экземпляр класса Ship</p> |

| **Операция** | SaveShip(ship)                                       |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Расставить корабли"                       |
| Предусловия  | Создан экземпляр класса Ship                         |
| Постусловия  | В атрибут ships текущего экземпляра класса Game добавлен созданный ship |

| **Операция** | AddShipToSet(ship)                                   |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Расставить корабли"                       |
| Предусловия  | <p>1. Создан экземпляр класса Ship</p><p>2. В атрибут ships текущего экземпляра класса Game добавлен созданный ship</p> |
| Постусловия  | В атрибут ships (список) текущего элемента списка players (эксземпляров класса Player) добавлен созданный ship |

| **Операция** | SetCellType(type)                                    |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Расставить корабли"                       |
| Предусловия  | <p>1. Создан экземпляр класса Ship</p><p>2. В атрибут ships текущего экземпляра класса Game добавлен созданный ship</p> |
| Постусловия  | В атрибут type эксземпляра класса Cell добавлено значение атрибута type экземпляра класса Ship |

| **Операция** | SaveShipsPlacement()                                 |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Расставить корабли"                       |
| Предусловия  | <p>1. Игрок расставил корабли по полю</p><p>2.  В атрибут ships текущего экземпляра класса Game добавлен созданный ship</p><p>3. В атрибут ships (список) текущего элемента списка players (эксземпляров класса Player) добавлен созданный ship</p><p>4. В атрибут type эксземпляра класса Cell добавлено значение атрибута type экземпляра класса Ship </p> |
| Постусловия  | Игроку предоставлен интерфейс (кнопка) для подтверждения расстановки кораблей и перехода к выбору первого игрока (либо передачи хода другому игроку) |

| **Операция** | EndPlacement()                                       |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Расставить корабли"                       |
| Предусловия  | <p>1. Игрок расставил корабли по полю</p><p>2.  Игрок нажал кнопку "Сохранить"</p> |
| Постусловия  | Игрок переходит к выбору первого игрока либо передает ход другому игроку |


## Прецедент "Выбрать первого игрока"

Рисунок 3 - Диаграмма взаимодействия для прецедента "Выбрать первого игрока"

![Рисунок 3 - Диаграмма взаимодействия для прецедента "Выбрать первого игрока"](/images/lab4_3.drawio3.png)

| **Операция** | StartChoiceFirst()                                   |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Выбрать первого игрока"                   |
| Предусловия  | <p>1.	Новая игра не начата</p><p>2.	Оба игрока расставили корабли</p><p>3.	Игрок нажал кнопку "Сохранить"</p> |
| Постусловия  | Открыт экран выбора первого игрока                   |

| **Операция** | GetPlayers()                                         |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Выбрать первого игрока"                   |
| Предусловия  | Открыт экран выбора первого игрока                   |
| Постусловия  | В атрибут players (список) текущего экземпляра класса Game добавлен список экземпляров класса Player |

| **Операция** | DisplayPlayers(players[])                            |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Выбрать первого игрока"                   |
| Предусловия  | <p>1.	Открыт экран выбора первого игрока</p><p>2.	В атрибут players (список) текущего экземпляра класса Game добавлен список экземпляров класса Player</p> |
| Постусловия  | Игроку предоставлен интерфейс для выбора первого игрока |

| **Операция** | ChooseFirst()                                        |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Выбрать первого игрока"                   |
| Предусловия  | Игроку предоставлен интерфейс для выбора первого игрока |
| Постусловия  | Игрок выбрал первого игрока (нажал на имя) и порядок игроков записан в order[] |

| **Операция** | SetOrder(order[])                                    |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Выбрать первого игрока"                   |
| Предусловия  | Игрок выбрал первого игрока и порядок игроков записан в order[] |
| Постусловия  | В атрибут order текущего элемента списка players (эксземпляров класса Player) добавлено значение соотв. по индексу элемента order[] |


## Прецедент "Сделать ход"

Рисунок 4 - Диаграмма взаимодействия для прецедента "Сделать ход"

![Рисунок 4 - Диаграмма взаимодействия для прецедента "Сделать ход"](/images/lab4_4.drawio3.png)

| **Операция** | StartGame()                                          |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | <p>1.	Новая игра не начата</p><p>2.	Оба игрока расставили корабли</p><p>3.	Выбран первый игрок</p> |
| Постусловия  | <p>1.	Игра начата, открыт экран игры</p><p>2.	Создан экземпляр move класса Move. Атрибуту текущего экземпляра класса Game присвоено значение move</p> |

| **Операция** | StartFirstMove()                                     |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | <p>1.	Игра начата</p><p>2.	Создан экземпляр move класса Move. Атрибуту текущего экземпляра класса Game присвоено значение move</p><p>3.	Текущий ход первый в игре (атрибут mode.id == 0) или повторный (атрибут mode.isRepeat == True)</p><p>4.	У обоих игроков есть непотопленные корабли</p> |
| Постусловия  | Ход предоставляется первому игроку, либо (при повторном ходе) тому же игроку, что и в предыдущем ходе |

| **Операция** | StartMove()                                          |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | <p>1.	Текущий ход не первый в игре (атрибут mode.id != 0) и не повторный (атрибут mode.isRepeat == False)</p><p>2.	У обоих игроков есть непотопленные корабли</p><p>3.	Предыдущий игрок нажа кнопку "Передать ход"</p> |
| Постусловия  | Ход предоставляется игроку, отличному от игрока в предыдущем ходе, и игрок нажимает кнопку "Далее" |

| **Операция** | GetCells()                                           |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | Начат новый ход                                      |
| Постусловия  | В атрибут cells (список) текущего экземпляра класса Game добавлен список экземпляров класса Cell |

| **Операция** | DisplayField(cells[])                                |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | В атрибут cells (список) текущего экземпляра класса Game добавлен список экземпляров класса Cell |
| Постусловия  | Игроку предоставлен интерфейс для осуществления хода |

| **Операция** | ClickCell(cell)                                      |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | <p>1.	В атрибут cells (список) текущего экземпляра класса Game добавлен список экземпляров класса Cell</p><p>2.	Игроку предоставлен интерфейс поля для осуществления хода</p> |
| Постусловия  | Игрок нажал на клетку на поле соперника, в которую "выстрелит" (cell) |

| **Операция** | CheckCell(cell)                                      |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | Игрок нажал на клетку на поле соперника, в которую "выстрелит" |
| Постусловия  | Проверяется состояние (значение атрибута state) клетки после "выстрела" в соотв. с предыдущим значением атрибута state, значением атрибута type и переданной cell|

| **Операция** | SetCellState(state)                                  |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | Состояние (state) клетки проверено                   |
| Постусловия  | В атрибут state соотв. экземпляра класса Cell добавлено значение атрибута state переданной cell |

| **Операция** | SetShipState(state)                                  |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | Состояние (state) клетки обновлено                   |
| Постусловия  | Значение атрибута state экземпляра класса Ship, соотв. предыдущ. экземпляру класса Cell, обновлено в соотв. со значением cell.state |

| **Операция** | SetMoveCell(cell_id, state)                                   |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | Состояние (state) клетки и корабля обновлены         |
| Постусловия  | Значения атрибутов move.state и move.cell_id обновлено в соотв. со значениями атрибутов cell.state и cell.id |

| **Операция** | Unharmed()                                           |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | <p>1.	Значения атрибутов клетки, корабля и хода обновлены</p><p>2.	Клетка пустая (cell.type == 0)</p> |
| Постусловия  | На поле соперника в клетке ставится точка, над полем выведен текст "Мимо!" |

| **Операция** | Injured()                                            |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | <p>1.	Значения атрибутов клетки, корабля и хода обновлены</p><p>2.	Клетка занята многопалубным кораблем и это его не последняя клетка</p> |
| Постусловия  | На поле соперника в клетке ставится крестик, над полем выведен текст "Ранил!" |

| **Операция** | Killed()                                             |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | <p>1.	Значения атрибутов клетки, корабля и хода обновлены</p><p>2.	Клетка занята однопалубным кораблем или многопалубным и это его последняя клетка</p> |
| Постусловия  | Клетка/клетки потопленного корабля закрашены, над полем выведен текст "Убит!" |

| **Операция** | CheckEndGame(players[])                                       |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | Игра начата |
| Постусловия  | Осуществлена проверка значений атрибута rest (остаток непотопленных кораблей) для обоих экземпляров класса Player, содержащихся в списке players |

| **Операция** | EndMove()                                            |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | <p>1.	Осуществлена проверка значений атрибута rest (остаток) для обоих экземпляров класса Player</p><p>2.	У обоих игроков значение атрибута rest != 0 (есть непотопленные корабли) </p> |
| Постусловия  | Игроку отображена кнопка "Передать ход" </p>         |

| **Операция** | SetWinner()                                          |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | <p>1.	Осуществлена проверка значений атрибута rest (остаток) для обоих экземпляров класса Player</p><p>2.	У одного из игроков значение атрибута rest == 0 (нет непотопленных кораблей) </p> |
| Постусловия  | Победителем назначен игрок с rest != 0 </p>          |

| **Операция** | ShowResults()                                        |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | Победитель игры назначен                             |
| Постусловия  | Выведены игровые поля, текст "Победил <имя игрока-победителя>" и кнопка "Выйти" |

| **Операция** | ClickExit()                                          |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | Результаты игры выведены на экран                    |
| Постусловия  | Игрок нажал кнопку "Выйти"                           |

| **Операция** | EndGame()                                            |
| ------------ | ---------------------------------------------------- |
| Ссылки       | Прецедент "Сделать ход"                              |
| Предусловия  | Игрок нажал кнопку "Выйти"                           |
| Постусловия  | Игра завершена, система игры остановлена             |
